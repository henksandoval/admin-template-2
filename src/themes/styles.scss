@use './theme';
@use '@angular/material' as mat;

// Tailwind CSS directives
@tailwind base;
@tailwind components;
@tailwind utilities;

// Incluir core de Material
@include mat.core();

// Definir variables de tema
$light-theme: theme.$light-theme;
$dark-theme: theme.$dark-theme;

// Tema claro por defecto
:root,
.light-theme {
  @include mat.all-component-themes($light-theme);
}

// Tema oscuro
.dark-theme {
  @include mat.all-component-themes($dark-theme);
}

// Aplicar colores globales al body
body.light-theme {
  background-color: var(--mat-sys-surface);
  color: var(--mat-sys-on-surface);
}

body.dark-theme {
  background-color: var(--mat-sys-surface);
  color: var(--mat-sys-on-surface);
}

// Variables CSS adicionales para sombras y overlays
:root {
  --mat-sys-level1-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  --mat-sys-level2-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  --mat-sys-level3-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
  --mat-sys-scrim: rgba(0, 0, 0, 0.32);
}

.dark-theme {
  --mat-sys-level1-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  --mat-sys-level2-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  --mat-sys-level3-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
  --mat-sys-scrim: rgba(0, 0, 0, 0.6);
}

// Asegurar que app-root y app-layout hereden el tema correctamente
app-root, app-layout {
  display: block;
  min-height: 100vh;
  background-color: inherit;
  color: inherit;
}

// Asegurar que los overlays hereden el tema correctamente
.cdk-overlay-container,
.cdk-overlay-pane {
  background-color: transparent;
}

// Estilos específicos para overlays en tema oscuro
.dark {
  // Datepicker overlay
  .mat-datepicker-popup {
    background-color: #{mat.get-theme-color($dark-theme, surface-container)};
    color: #{mat.get-theme-color($dark-theme, on-surface)};
  }

  // Select overlay
  .mat-mdc-select-panel {
    background-color: #{mat.get-theme-color($dark-theme, surface-container)};
    color: #{mat.get-theme-color($dark-theme, on-surface)};
  }

  // Autocomplete overlay
  .mat-mdc-autocomplete-panel {
    background-color: #{mat.get-theme-color($dark-theme, surface-container)};
    color: #{mat.get-theme-color($dark-theme, on-surface)};
  }

  // Menu overlay
  .mat-mdc-menu-panel {
    background-color: #{mat.get-theme-color($dark-theme, surface-container)};
    color: #{mat.get-theme-color($dark-theme, on-surface)};
  }

  // Tooltip overlay
  .mat-mdc-tooltip {
    background-color: #{mat.get-theme-color($dark-theme, inverse-surface)};
    color: #{mat.get-theme-color($dark-theme, inverse-on-surface)};
  }

  // Dialog overlay
  .mat-mdc-dialog-container {
    background-color: #{mat.get-theme-color($dark-theme, surface-container-high)};
    color: #{mat.get-theme-color($dark-theme, on-surface)};
  }

  // Backdrop styling
  .cdk-overlay-backdrop {
    background: var(--mat-sys-scrim);

    &.cdk-overlay-backdrop-showing {
      opacity: 1;
    }
  }
}

// Estilos globales para overlays que se aplican independientemente del tema
.cdk-overlay-container {
  z-index: 1000;

  &.dark {
    // Datepicker overlay
    .mat-datepicker-popup {
      background-color: #{mat.get-theme-color($dark-theme, surface-container)};
      color: #{mat.get-theme-color($dark-theme, on-surface)};
    }

    // Select overlay
    .mat-mdc-select-panel {
      background-color: #{mat.get-theme-color($dark-theme, surface-container)};
      color: #{mat.get-theme-color($dark-theme, on-surface)};
    }

    // Autocomplete overlay
    .mat-mdc-autocomplete-panel {
      background-color: #{mat.get-theme-color($dark-theme, surface-container)};
      color: #{mat.get-theme-color($dark-theme, on-surface)};
    }

    // Menu overlay
    .mat-mdc-menu-panel {
      background-color: #{mat.get-theme-color($dark-theme, surface-container)};
      color: #{mat.get-theme-color($dark-theme, on-surface)};
    }

    // Tooltip overlay
    .mat-mdc-tooltip {
      background-color: #{mat.get-theme-color($dark-theme, inverse-surface)};
      color: #{mat.get-theme-color($dark-theme, inverse-on-surface)};
    }

    // Dialog overlay
    .mat-mdc-dialog-container {
      background-color: #{mat.get-theme-color($dark-theme, surface-container-high)};
      color: #{mat.get-theme-color($dark-theme, on-surface)};
    }
  }
}

// Asegurar que el backdrop no afecte el contenido de la página
.cdk-global-overlay-wrapper,
.cdk-overlay-container {
  pointer-events: none;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
}

.cdk-overlay-pane {
  pointer-events: auto;
  box-sizing: border-box;
}

/* Estilos globales */
html, body {
  height: 100%;
  margin: 0;
  font-family: Roboto, "Helvetica Neue", sans-serif;
  transition: background-color 0.3s ease, color 0.3s ease;
}

* {
  box-sizing: border-box;
}

// Asegurar que las clases de Material Design funcionen correctamente
.mat-app-background {
  background-color: var(--mat-sys-background);
  color: var(--mat-sys-on-background);
  transition: background-color 0.3s ease, color 0.3s ease;
}

.mat-sidenav-content {
  background-color: var(--mat-sys-surface);
  color: var(--mat-sys-on-surface);
}

// Estilos para tipografía de Material Design
.mat-headline-large {
  color: var(--mat-sys-on-surface);
}

.mat-body-medium,
.mat-body-strong {
  color: var(--mat-sys-on-surface-variant);
}

.mat-caption {
  color: var(--mat-sys-on-surface-variant);
}

// Hover para links
a:hover {
  color: var(--mat-sys-primary);
}

// ================================================
// GLOBAL SCROLLBAR STYLES (Application-wide)
// ================================================

/* Standard global scrollbar for the main document */
:global(html) {
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--mat-sys-outline-rgb), 0.3) transparent;
  scroll-behavior: smooth;
}

:global(body)::-webkit-scrollbar {
  width: 0.625rem; /* 10px */
}

:global(body)::-webkit-scrollbar-track {
  background: var(--mat-sys-surface-container-lowest);
  border-radius: 0.3125rem; /* 5px */
}

:global(body)::-webkit-scrollbar-thumb {
  background: linear-gradient(
    180deg,
    rgba(var(--mat-sys-outline-rgb), 0.3) 0%,
    rgba(var(--mat-sys-outline-rgb), 0.5) 50%,
    rgba(var(--mat-sys-outline-rgb), 0.3) 100%
  );
  border-radius: 0.3125rem; /* 5px */
  border: 1px solid rgba(var(--mat-sys-outline-rgb), 0.1);
  transition: all 0.3s ease;
}

:global(body)::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(
    180deg,
    rgba(var(--mat-sys-outline-rgb), 0.4) 0%,
    rgba(var(--mat-sys-outline-rgb), 0.6) 50%,
    rgba(var(--mat-sys-outline-rgb), 0.4) 100%
  );
  transform: scaleX(1.2);
}

/* Dark theme adaptations for global scrollbar */
:host-context(.dark) :global(body)::-webkit-scrollbar-track {
  background: var(--mat-sys-surface-container-high);
}

// ================================================
// SASS MIXINS FOR DRY PRINCIPLES
// ================================================

// Base transition mixin
@mixin smooth-transition($properties: all, $duration: 0.3s, $easing: ease) {
  transition: $properties $duration $easing;
}

// Hover transform mixin
@mixin hover-transform($transform: translateY(-0.125rem)) {
  @include smooth-transition(transform, 0.2s, ease-in-out);
  
  &:hover {
    transform: $transform;
  }
}

// Centered flex mixin
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

// ================================================
// SCROLLBAR UTILITY VARIANTS
// ================================================

/* Default scrollbar - for general content areas */
.scrollbar-default {
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--mat-sys-outline-rgb), 0.3) transparent;
  scroll-behavior: smooth;

  &::-webkit-scrollbar {
    width: 0.625rem; /* 10px */
  }

  &::-webkit-scrollbar-track {
    background: var(--mat-sys-surface-container-lowest);
    border-radius: 0.3125rem; /* 5px */
  }

  &::-webkit-scrollbar-thumb {
    background: linear-gradient(
      180deg,
      rgba(var(--mat-sys-outline-rgb), 0.3) 0%,
      rgba(var(--mat-sys-outline-rgb), 0.5) 50%,
      rgba(var(--mat-sys-outline-rgb), 0.3) 100%
    );
    border-radius: 0.3125rem; /* 5px */
    border: 1px solid rgba(var(--mat-sys-outline-rgb), 0.1);
    transition: all 0.3s ease;
  }

  &::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(
      180deg,
      rgba(var(--mat-sys-outline-rgb), 0.4) 0%,
      rgba(var(--mat-sys-outline-rgb), 0.6) 50%,
      rgba(var(--mat-sys-outline-rgb), 0.4) 100%
    );
    transform: scaleX(1.2);
  }
}

/* Primary scrollbar - for sidebar and navigation elements */
.scrollbar-primary {
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--mat-sys-primary-rgb), 0.2) transparent;
  scroll-behavior: smooth;

  &::-webkit-scrollbar {
    width: 0.5rem; /* 8px */
  }

  &::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 0.25rem; /* 4px */
  }

  &::-webkit-scrollbar-thumb {
    background: linear-gradient(
      135deg,
      rgba(var(--mat-sys-primary-rgb), 0.3) 0%,
      rgba(var(--mat-sys-primary-rgb), 0.5) 50%,
      rgba(var(--mat-sys-primary-rgb), 0.3) 100%
    );
    border-radius: 0.25rem; /* 4px */
    border: 1px solid rgba(var(--mat-sys-primary-rgb), 0.1);
    transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  &::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(
      135deg,
      rgba(var(--mat-sys-primary-rgb), 0.5) 0%,
      rgba(var(--mat-sys-primary-rgb), 0.7) 50%,
      rgba(var(--mat-sys-primary-rgb), 0.5) 100%
    );
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    transform: scaleY(1.1);
  }

  &::-webkit-scrollbar-thumb:active {
    background: linear-gradient(
      135deg,
      rgba(var(--mat-sys-primary-rgb), 0.6) 0%,
      rgba(var(--mat-sys-primary-rgb), 0.8) 50%,
      rgba(var(--mat-sys-primary-rgb), 0.6) 100%
    );
  }

  /* Enhanced primary scrollbar with gradient edges and glow effects */
  &.scrollbar-enhanced {
    &::before,
    &::after {
      content: '';
      position: sticky;
      display: block;
      height: 1.25rem; /* 20px */
      z-index: 10;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    &::before {
      top: 0;
      background: linear-gradient(
        to bottom,
        var(--mat-sys-surface) 0%,
        rgba(var(--mat-sys-surface-rgb), 0.8) 50%,
        transparent 100%
      );
      margin-bottom: -1.25rem; /* -20px */
    }

    &::after {
      bottom: 0;
      background: linear-gradient(
        to top,
        var(--mat-sys-surface) 0%,
        rgba(var(--mat-sys-surface-rgb), 0.8) 50%,
        transparent 100%
      );
      margin-top: -1.25rem; /* -20px */
    }

    &:hover {
      box-shadow: inset 2px 0 4px rgba(var(--mat-sys-primary-rgb), 0.1);
    }

    &:active {
      animation: scrollGlow 0.6s ease-in-out;
    }
  }

  /* Dark theme adaptations */
  :host-context(.dark) &::-webkit-scrollbar-thumb {
    border: 1px solid rgba(var(--mat-sys-primary-rgb), 0.2);
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    &::-webkit-scrollbar {
      width: 0.25rem; /* 4px */
    }
  }
}

/* Scroll glow animation for enhanced scrollbars */
@keyframes scrollGlow {
  0% { box-shadow: inset 2px 0 4px rgba(var(--mat-sys-primary-rgb), 0.1); }
  50% { box-shadow: inset 2px 0 8px rgba(var(--mat-sys-primary-rgb), 0.2); }
  100% { box-shadow: inset 2px 0 4px rgba(var(--mat-sys-primary-rgb), 0.1); }
}

// ================================================
// REUSABLE INTERACTION UTILITIES
// ================================================

/* Hover lift effect for cards - truly reusable across multiple components */
.card-hover-lift {
  @include hover-transform(translateY(-0.125rem)); /* -2px */
}

/* Circular avatar with centered icon - reusable pattern */
.avatar-icon {
  @include flex-center;
  width: 2.5rem; /* 40px */
  height: 2.5rem; /* 40px */
  border-radius: 50%;
  
  mat-icon {
    font-size: 1.5rem; /* 24px */
    width: 1.5rem; /* 24px */
    height: 1.5rem; /* 24px */
  }
}

/* Hover scale effect for interactive elements - truly reusable */
.hover-scale {
  @include smooth-transition(all, 0.3s, ease);
  
  &:hover {
    transform: scale(1.1);
  }
}

// Custom utilities that complement Tailwind and Angular Material
// (mantener solo utilidades específicas que no proporciona Tailwind)

// ================================================
// JOBMAGNETIC TYPOGRAPHY SYSTEM
// ================================================

/* Jerarquía tipográfica coherente para JobMagnetic Admin */

// Fuente base del cuerpo
body {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif;
  font-weight: 400;
  line-height: 1.6;
  letter-spacing: 0.01em;
}

// Títulos principales (Dashboard, páginas principales)
.jobmagnetic-title,
h1, .mat-headline-large {
  font-family: 'Poppins', 'Inter', sans-serif !important;
  font-weight: 700;
  letter-spacing: -0.02em;
  line-height: 1.2;
}

// Subtítulos y secciones
.jobmagnetic-subtitle,
h2, .mat-headline-medium {
  font-family: 'Poppins', 'Inter', sans-serif !important;
  font-weight: 600;
  letter-spacing: -0.01em;
  line-height: 1.3;
}

// Títulos de componentes y cards
.jobmagnetic-heading,
h3, .mat-headline-small, .mat-title-large {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 600;
  letter-spacing: 0;
  line-height: 1.4;
}

// Títulos secundarios
.jobmagnetic-subheading,
h4, .mat-title-medium {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 500;
  letter-spacing: 0.01em;
  line-height: 1.4;
}

// Títulos pequeños
.jobmagnetic-caption,
h5, h6, .mat-title-small {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 500;
  letter-spacing: 0.02em;
  line-height: 1.5;
}

// Texto del cuerpo
.jobmagnetic-body,
p, .mat-body-large, .mat-body-medium {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 400;
  letter-spacing: 0.01em;
  line-height: 1.6;
}

// Texto pequeño y etiquetas
.jobmagnetic-small,
small, .mat-body-small, .mat-caption {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 400;
  letter-spacing: 0.02em;
  line-height: 1.5;
}

// Botones y elementos interactivos
.jobmagnetic-button,
.mat-mdc-button, .mat-mdc-outlined-button, .mat-mdc-unelevated-button {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 500;
  letter-spacing: 0.02em;
}

// Navegación y menús
.jobmagnetic-nav,
.mat-mdc-menu-item, .sidebar-item, nav,
.mat-mdc-list-item, .mat-mdc-nav-list {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 400;
  letter-spacing: 0.01em;
}

// Breadcrumbs y navegación secundaria
.breadcrumb, .mat-breadcrumb,
.back-button, .navigation-link {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
  font-weight: 400;
  letter-spacing: 0.01em;
}

// Código y elementos monospace
.jobmagnetic-code,
code, pre, .mat-code {
  font-family: 'JetBrains Mono', 'Consolas', monospace !important;
  font-weight: 400;
  letter-spacing: 0;
  line-height: 1.5;
}

// ================================================
// UTILITY CLASSES ESPECÍFICAS
// ================================================

.font-brand {
  font-family: 'Poppins', 'Inter', sans-serif !important;
}

.font-body {
  font-family: 'Plus Jakarta Sans', 'Inter', sans-serif !important;
}

.font-code {
  font-family: 'JetBrains Mono', 'Consolas', monospace !important;
}

// Pesos específicos
.font-light { font-weight: 300; }
.font-normal { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }
.font-extrabold { font-weight: 800; }
